---
import Button from "@/components/ui/button/button.astro";
import { cn } from "@/lib/utils";
import { Image } from "astro:assets";

const {
  title,
  text,
  image,
  imageAlt,
  buttonText,
  buttonLink,
  buttonVariant,
  buttonExternal = false,
  withBackground = true,
} = Astro.props;

const paragraphs = Array.isArray(text)
  ? text.filter(Boolean)
  : typeof text === "string"
    ? text.split(/\n\s*\n/).filter(Boolean)
    : [];
---

<header
  class="relative grid gap-10 px-4 pt-12 md:px-10 lg:grid-cols-2 lg:gap-20 lg:px-20"
>
  <span
    class={cn(
      "-z-10 absolute w-screen left-1/2 -translate-x-1/2 top-0 bottom-0 xl:bottom-16",
      withBackground && "bg-muted",
    )}></span>
  <Image
    class="aspect-video lg:aspect-11/12"
    quality="mid"
    src={image}
    alt={imageAlt}
  />
  <div class="flex flex-col justify-center gap-8 pb-16">
    <h1>{title}</h1>
    {
      paragraphs.length > 0 && (
        <div class="flex flex-col gap-4">
          {paragraphs.map((paragraph) => (
            <p>{paragraph}</p>
          ))}
        </div>
      )
    }
    {
      buttonLink && buttonText && (
        <Button
          class={cn("self-baseline", buttonVariant === "secondary" && "pl-0")}
          variant={buttonVariant}
          href={buttonLink}
          external={buttonExternal}
        >
          {buttonText}
        </Button>
      )
    }
  </div>
</header>
