---
import Button from "@/components/ui/button/button.astro";
import { cn } from "@/lib/utils";

const {
  title,
  text,
  image,
  imageAlt,
  buttonText,
  buttonLink,
  buttonVariant,
  buttonExternal = false,
  withBackground = true,
} = Astro.props;

const paragraphs = Array.isArray(text)
  ? text.filter(Boolean)
  : typeof text === "string"
    ? text.split(/\n\s*\n/).filter(Boolean)
    : [];
---

<header class="relative grid sm:grid-cols-2 md:gap-20 px-20 pt-12">
  <span
    class={cn(
      "-z-10 absolute inset-x-0 top-0 bottom-16",
      withBackground && "bg-muted"
    )}></span>
  <img class="aspect-11/12" src={image} alt={imageAlt} />
  <div class="flex flex-col justify-center gap-8 pb-16">
    <h1>{title}</h1>
    {
      paragraphs.length > 0 && (
        <div class="flex flex-col gap-4">
          {paragraphs.map((paragraph, index) => (
            <p key={index}>{paragraph}</p>
          ))}
        </div>
      )
    }
    <Button
      class={cn("self-baseline", buttonVariant === "secondary" && "-ml-6")}
      variant={buttonVariant}
      href={buttonLink}
      external={buttonExternal}
    >
      {buttonText}
    </Button>
  </div>
</header>
