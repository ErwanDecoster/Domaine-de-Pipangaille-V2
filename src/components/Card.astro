---
import { Image } from "astro:assets";
import { Button } from "./ui/button";

interface Props {
  title: string;
  image: ImageMetadata;
  imageAlt: string;
  description: string;
  buttonText: string;
  buttonLink: string;
  tags?: { icon?: any; text: string }[];
  class?: string;
}

const {
  title,
  image,
  imageAlt,
  description,
  buttonText,
  buttonLink,
  tags,
  class: className,
} = Astro.props;
---

<article
  class={`space-y-4 relative bg-accent rounded-[16px] p-2 ${className}`}
  style={`--card-image: url(${image.src});`}
>
  <Image class="aspect-video" src={image} alt={imageAlt} />
  <div class="flex gap-2.5 absolute top-4 left-4">
    {
      tags &&
        tags.map((tag) => (
          <span class="bg-background rounded-sm px-2 py-1 flex items-center gap-1.5 text-sm">
            {tag.icon && <tag.icon size={16} />}
            <span>{tag.text}</span>
          </span>
        ))
    }
  </div>
  <div class="px-2 space-y-6">
    <div class="space-y-4">
      <h3>{title}</h3>
      <p>{description}</p>
    </div>
    <Button class="pl-0" href={buttonLink} variant="secondary">
      {buttonText}
    </Button>
  </div>
</article>

<style>
  article {
    position: relative;
    isolation: isolate; /* keeps the blur behind inner content */
    background: transparent;
    overflow: hidden;
  }

  article::before {
    content: "";
    position: absolute;
    inset: 0;
    background-image: var(--card-image);
    background-size: cover;
    background-position: center;
    filter: blur(1200px) saturate(200%);
    transform: scale(1.1);
    opacity: 0;
    z-index: -1;
    transition: opacity 0.2s ease-in-out;
  }
  article:hover::before {
    opacity: 0.4;
  }
  article:focus-within::before {
    opacity: 0.6;
  }
</style>
